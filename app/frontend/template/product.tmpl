{{ define "product" }}
    {{ template "header" . }}
    <div class="container mt-4">
        <div class="row g-4">
            <!-- 商品图册 -->
            <div class="col-lg-6">
                <div id="mediaCarousel" class="carousel slide">
                    <div class="carousel-indicators">
                        {{ range $index, $img := .SPU.Media.MainImages }}
                            <button type="button"
                                    data-bs-target="#mediaCarousel"
                                    data-bs-slide-to="{{ $index }}"
                                    class="{{ if eq $index 0 }}active{{ end }}"
                                    aria-label="Slide {{ $index | printf "%d" }}"></button>
                        {{ end }}
                    </div>
                    <div class="carousel-inner ratio ratio-1x1 bg-light">
                        {{ range $index, $img := .SPU.Media.MainImages }}
                            <div class="carousel-item {{ if eq $index 0 }}active{{ end }}">
                                <img src="{{ $img }}"
                                     class="d-block w-100 object-fit-contain p-3"
                                     alt="{{ $.SPU.BasicInfo.Title }} 主图{{ $index | printf "%d" }}">
                            </div>
                        {{ else }}
                            <div class="carousel-item active">
                                <div class="d-flex align-items-center justify-content-center h-100">
                                    <i class="fas fa-image fa-4x text-muted"></i>
                                </div>
                            </div>
                        {{ end }}
                    </div>
                    <button class="carousel-control-prev" type="button" data-bs-target="#mediaCarousel" data-bs-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Previous</span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#mediaCarousel" data-bs-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Next</span>
                    </button>
                </div>
            </div>

            <!-- 商品信息 -->
            <div class="col-lg-6">
                <div class="vstack gap-3">
                    <!-- 商品标题 -->
                    <h1 class="h2 fw-bold">{{ .SPU.BasicInfo.Title }}</h1>
                    {{ if .SPU.BasicInfo.SubTitle }}
                        <h2 class="h5 text-muted">{{ .SPU.BasicInfo.SubTitle }}</h2>
                    {{ end }}

                    <!-- 价格显示 -->
                    <div class="d-flex align-items-center gap-2">
                        <span class="h3 text-danger fw-bold">
                            ¥{{ printf "%.2f" (index .SPU.Skus 0).Price }}
                        </span>
                        {{ if gt (len .SPU.Skus) 1 }}
                            <span class="text-muted small">起</span>
                        {{ end }}
                    </div>

                    <!-- 规格选择 -->
                    {{ range .SPU.Skus }}
                        <div class="spec-group">
                            <div class="d-flex flex-wrap gap-2">
                                    <button type="button"
                                            class="btn btn-outline-dark btn-sm spec-item">
{{/*                                                data-spec="{{ $specName }}"*/}}
{{/*                                                data-value="{{ $specValue }}">*/}}
                                        {{ range $specName, $specValue := .Specs }}
                                        {{ $specName }}:{{ $specValue }}
                                        {{end}}
                                    </button>
                            </div>
                        </div>
                    {{ end }}
                    <!-- 商品详情 -->
                    <!-- 商品详情 -->
                    <div class="row mt-4">  <!-- 减少容器上边距 -->
                        <div class="col-12">
                            <div class="card border-0 shadow-sm">
                                <div class="card-body p-4">  <!-- 减少内边距 -->
                                    <!-- 标题区块 -->
                                    <div class="d-flex align-items-center mb-3 pb-2 border-bottom">  <!-- 减少下边距 -->
                                        <i class="fas fa-file-alt me-2 text-primary fs-5"></i>  <!-- 缩小图标 -->
                                        <h5 class="card-title mb-0 fs-5 fw-semibold">商品详情</h5>
                                    </div>

                                    <!-- 内容区块保持不变 -->
                                    <div class="content lh-lg" style="font-size: 0.95rem">
                                        {{ .SPU.BasicInfo.Description}}
                                        {{ if not .SPU.BasicInfo.Description }}
                                            <div class="text-muted text-center py-4">
                                                <i class="fas fa-info-circle me-2"></i>该商品暂无详细描述
                                            </div>
                                        {{ end }}
                                    </div>

                                    <!-- 扩展信息对齐优化 -->
                                    <div class="mt-4 pt-3 border-top">
                                        <div class="row row-cols-1 row-cols-md-2 g-3">  <!-- 使用cols布局 -->
                                            <!-- 参数卡片 -->
                                            <div class="col">
                                                <div class="bg-light rounded p-3 h-100">  <!-- 添加等高 -->
                                                    <h6 class="d-flex align-items-center mb-3">
                                                        <i class="fas fa-tag me-2 text-muted fs-6"></i>基本信息
                                                    </h6>
                                                    <dl class="row mb-0 small">
                                                        <dt class="col-5 text-muted">商品品牌</dt>
                                                        <dd class="col-7">{{ .SPU.BasicInfo.Brand }}</dd>

                                                        <dt class="col-5 text-muted">所属店铺</dt>
                                                        <dd class="col-7">店铺ID: {{ .SPU.BasicInfo.ShopId }}</dd>
                                                    </dl>
                                                </div>
                                            </div>

                                            <!-- 服务承诺 -->
                                            <div class="col">
                                                <div class="bg-light rounded p-3 h-100">  <!-- 添加等高 -->
                                                    <h6 class="d-flex align-items-center mb-3">
                                                        <i class="fas fa-shield-alt me-2 text-muted fs-6"></i>服务保障
                                                    </h6>
                                                    <ul class="list-unstyled mb-0 small">
                                                        <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>正品保证</li>
                                                        <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>7天无理由退货</li>
                                                        <li><i class="fas fa-check-circle text-success me-2"></i>售后无忧</li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 购买表单 -->
                    <form action="/cart" method="post" class="mt-4">
                        <input type="hidden" name="productId" value="{{ .SPU.Id }}">
{{/*                        <input type="hidden" name="skuId" value="{{ (index .SPU.Skus 0).Id }}">*/}}

                        <div class="row g-3 align-items-center">
                            <div class="col-auto">
                                <label for="productNum" class="form-label">数量</label>
                            </div>
                            <div class="col-4">
                                <input type="number"
                                       id="productNum"
                                       name="productNum"
                                       class="form-control"
                                       value="1"
                                       min="1"
                                       max="{{ (index .SPU.Skus 0).Stock }}">
                            </div>
                            <div class="col">
                                <button type="submit" class="btn btn-danger w-100 py-2">
                                    <i class="fas fa-cart-plus me-2"></i>加入购物车
                                </button>
                            </div>
                        </div>
                    </form>

                    <!-- 服务承诺 -->
                    <div class="mt-4 border-top pt-3">
                        <div class="row g-2 small">
                            <div class="col-6 d-flex align-items-center gap-2">
                                <i class="fas fa-shield-alt text-primary"></i>
                                <span>正品保证</span>
                            </div>
                            <div class="col-6 d-flex align-items-center gap-2">
                                <i class="fas fa-truck text-primary"></i>
                                <span>全场包邮</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


    </div>

    {{ template "footer" . }}
{{ end }}